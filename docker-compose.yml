version: '3.7'

services:
  api-gateway:
    build:
      dockerfile: ./service.api-gateway/prod.dockerfile
      context: .
    volumes:
      - ./service.api-gateway/config.prod.yaml:/config/config.yaml
    ports:
      - 7000:80

  service.controller.switch:
    build:
      dockerfile: ./service.controller.switch/dev.dockerfile
      context: .
    volumes:
      - ./service.controller.switch:/usr/src/app
      - /usr/src/app/node_modules
    ports:
      - 7001:3000
    environment:
      NODE_ENV: development

  service.discord:
    build:
      dockerfile: ./service.discord/dev.dockerfile
      context: .
    volumes:
      - ./service.discord:/usr/src/app
      - /usr/src/app/node_modules
    ports:
      - 7002:3000
    env_file:
      - ./service.discord/.env
    environment:
      NODE_ENV: development
